<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Organizational Chart and Data Table</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }
        nav {
            background-color: #0078d4;
            padding: 10px;
            color: white;
        }
        nav a {
            color: white;
            margin-right: 15px;
            text-decoration: none;
        }
        nav a:hover {
            text-decoration: underline;
        }
        #orgChart, #dataTable {
            display: none;
        }
        #dataTable {
            margin: 20px;
            border-collapse: collapse;
            width: 95%;
        }
        #dataTable th, #dataTable td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        #dataTable th {
            background-color: #f4f4f4;
        }
        svg {
            background-color: #f4f4f4;
        }
    </style>
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <nav>
        <a href="#" id="showChart">Organizational Chart</a>
        <a href="#" id="showDataTable">Data Table</a>
    </nav>

    <!-- Organizational Chart Section -->
    <div id="orgChart">
        <input type="range" id="zoomSlider" min="0.5" max="2.5" step="0.1" value="1" />
        <button id="collapseAllBtn">Collapse All</button>
        <button id="expandAllBtn">Expand All</button>
        <select id="expandLevelDropdown">
            <option value="1">Expand to Level 1</option>
            <option value="2" selected>Expand to Level 2</option>
            <option value="3">Expand to Level 3</option>
            <option value="4">Expand to Level 4</option>
            <option value="5">Expand to Level 5</option>
        </select>
        <svg id="chart" width="100%" height="600"></svg>
    </div>

    <!-- Data Table Section -->
    <table id="dataTable">
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Manager ID</th>
                <th>Team</th>
                <th>Job Title</th>
            </tr>
        </thead>
        <tbody id="dataTableBody"></tbody>
    </table>

    <script>
        const employeeData = [
            { id: '1', name: 'John Doe', managerId: null, team: 'Leadership', jobTitle: 'CEO' },
            { id: '2', name: 'Jane Smith', managerId: '1', team: 'Leadership', jobTitle: 'CTO' },
            { id: '3', name: 'James Brown', managerId: '1', team: 'Leadership', jobTitle: 'CFO' },
            { id: '4', name: 'Emily Davis', managerId: '2', team: 'Engineering', jobTitle: 'Lead Engineer' },
            { id: '5', name: 'Michael Johnson', managerId: '2', team: 'Engineering', jobTitle: 'Software Engineer' },
            { id: '6', name: 'Jessica Williams', managerId: '3', team: 'Finance', jobTitle: 'Finance Manager' },
            { id: '7', name: 'Daniel Wilson', managerId: '3', team: 'Finance', jobTitle: 'Accountant' },
            { id: '8', name: 'Sophia Martinez', managerId: '4', team: 'Engineering', jobTitle: 'Product Manager' },
            { id: '9', name: 'David Garcia', managerId: '5', team: 'Engineering', jobTitle: 'QA Engineer' },
            { id: '10', name: 'Olivia Rodriguez', managerId: '6', team: 'Finance', jobTitle: 'Financial Analyst' },
            { id: '11', name: 'William Lee', managerId: '6', team: 'Finance', jobTitle: 'Auditor' },
            { id: '12', name: 'Emma Perez', managerId: '8', team: 'Engineering', jobTitle: 'UX Designer' },
            { id: '13', name: 'Liam Taylor', managerId: '8', team: 'Engineering', jobTitle: 'Frontend Developer' },
            { id: '14', name: 'Ava Thompson', managerId: '9', team: 'Engineering', jobTitle: 'Backend Developer' },
            { id: '15', name: 'Mason White', managerId: '7', team: 'Finance', jobTitle: 'Tax Specialist' },
            { id: '16', name: 'Isabella Harris', managerId: '1', team: 'Leadership', jobTitle: 'COO' },
            { id: '17', name: 'Ethan Clark', managerId: '16', team: 'Operations', jobTitle: 'Operations Manager' },
            { id: '18', name: 'Charlotte Lewis', managerId: '16', team: 'Operations', jobTitle: 'Logistics Coordinator' },
            { id: '19', name: 'Oliver Robinson', managerId: '5', team: 'Engineering', jobTitle: 'DevOps Engineer' },
            { id: '20', name: 'Sophia Walker', managerId: '4', team: 'Engineering', jobTitle: 'Data Scientist' }
        ];

        // Show the organizational chart page by default
        document.getElementById("orgChart").style.display = "block";
        document.getElementById("dataTable").style.display = "none";

        // Navigation to show chart or data table
        document.getElementById("showChart").onclick = function () {
            document.getElementById("orgChart").style.display = "block";
            document.getElementById("dataTable").style.display = "none";
            updateChart();
        };

        document.getElementById("showDataTable").onclick = function () {
            document.getElementById("orgChart").style.display = "none";
            document.getElementById("dataTable").style.display = "block";
            populateDataTable();
        };

        // Organizational Chart Setup
        const svg = d3.select("#chart");
        const width = window.innerWidth;
        const height = 600;

        const root = d3.stratify()
            .id((d) => d.id)
            .parentId((d) => d.managerId)(employeeData);

        const treeLayout = d3.tree()
            .nodeSize([120, 150])
            .separation((a, b) => a.parent === b.parent ? 1 : 1.5);

        let treeData = treeLayout(root);
        let nodes = treeData.descendants();
        let links = treeData.links();

        // Collapse nodes at first render
        nodes.forEach((d) => {
            if (d.depth === 1) {
                collapse(d);
            }
        });

        function updateChart() {
            update(root);
        }

        function update(source) {
            treeData = treeLayout(root);
            nodes = treeData.descendants();
            links = treeData.links();

            svg.selectAll("*").remove();

            const link = svg.selectAll(".link")
                .data(links)
                .enter().append("path")
                .attr("class", "link")
                .attr("d", d3.linkVertical()
                    .x((d) => d.x)
                    .y((d) => d.y)
                )
                .attr("stroke-width", "2px");

            const node = svg.selectAll(".node")
                .data(nodes)
                .enter().append("g")
                .attr("class", "node")
                .attr("transform", (d) => `translate(${d.x},${d.y})`);

            node.append("rect")
                .attr("width", 120)
                .attr("height", 60)
                .attr("x", -60)
                .attr("y", -30)
                .style("fill", "#fff")
                .on("click", click);

            node.append("text")
                .attr("dy", "-5px")
                .attr("y", -10)
                .style("text-anchor", "middle")
                .text((d) => d.data.name);

            node.append("text")
                .attr("dy", "1.2em")
                .attr("y", -5)
                .style("text-anchor", "middle")
                .style("font-size", "10px")
                .text((d) => d.data.team);

            node.append("text")
                .attr("dy", "1.2em")
                .attr("y", 10)
                .style("text-anchor", "middle")
                .style("font-size", "10px")
                .text((d) => d.data.jobTitle);
        }

        function zoomed(event) {
            svg.attr("transform", event.transform);
        }

        function click(event, d) {
            d.children = d.children ? null : d._children;
            update(d);
        }

        function collapse(d) {
            if (d.children) {
                d._children = d.children;
                d.children = null;
            }
        }

        function expand(d) {
            if (d._children) {
                d.children = d._children;
                d._children = null;
            }
        }

        // Collapse all nodes initially
        d3.select("#collapseAllBtn").on("click", function () {
            nodes.forEach(collapse);
            update(root);
        });

        // Expand all nodes
        d3.select("#expandAllBtn").on("click", function () {
            nodes.forEach(expand);
            update(root);
        });

        // Expand to a specific level
        d3.select("#expandLevelDropdown").on("change", function () {
            const selectedLevel = parseInt(this.value);
            nodes.forEach(function (d) {
                if (d.depth < selectedLevel) {
                    expand(d);
                } else {
                    collapse(d);
                }
            });
            update(root);
        });

        // Zoom functionality
        d3.select("#zoomSlider").on("input", function () {
            const zoomLevel = d3.select(this).property("value");
            svg.attr("transform", `scale(${zoomLevel})`);
        });

        // Populate the data table with employee data
        function populateDataTable() {
            const tableBody = document.getElementById("dataTableBody");
            tableBody.innerHTML = ''; // Clear existing rows
            employeeData.forEach(emp => {
                const row = tableBody.insertRow();
                row.insertCell(0).innerText = emp.id;
                row.insertCell(1).innerText = emp.name;
                row.insertCell(2).innerText = emp.managerId || 'N/A';
                row.insertCell(3).innerText = emp.team;
                row.insertCell(4).innerText = emp.jobTitle;
            });
        }
    </script>
</body>
</html>
